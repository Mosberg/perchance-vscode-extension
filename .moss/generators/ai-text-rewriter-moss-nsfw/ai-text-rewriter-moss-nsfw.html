<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="[favicon]" type="image/x-icon" />
    <meta
      name="description"
      content="Rewrite any text with AI-powered Moss NSFW. Choose from various modes to customize your text rewriting experience."
    />
    <meta name="keywords" content="AI, text rewriter, Moss NSFW, rewrite text, AI modes" />
    <meta name="author" content="Moss NSFW" />
    <title>AI Text Rewriter Moss NSFW</title>
    <style>
      * {
        box-sizing: border-box;
      }

      :root {
        --primary-color: #4a90e2;
        --primary-hover: #357abd;
        --border-color: #ddd;
        --bg-secondary: #f8f9fa;
        --text-primary: #333;
        --text-secondary: #666;
        --text-muted: #999;
        --success-color: #27ae60;
        --transition: all 0.2s ease;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --border-color: #444;
          --bg-secondary: #2a2a2a;
          --text-primary: #e0e0e0;
          --text-secondary: #b0b0b0;
          --text-thirdary: #2a2a2a;
          --text-muted: #808080;
        }
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 1rem;
        color: var(--text-primary);
      }

      h1 {
        margin: 0 0 1.5rem 0;
        text-align: center;
        font-size: 2rem;
        font-weight: 700;
        letter-spacing: -0.5px;
      }

      .container {
        width: 95%;
        max-width: 750px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .section-title {
        font-size: 0.85rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        opacity: 0.8;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .mode-picker {
        background: var(--bg-secondary);
        padding: 1.5rem;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        color: var(--text-primary);
      }

      #currentModeEl {
        color: var(--text-thirdary);
      }

      .favorites-container {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1rem;
        min-height: 2.5rem;
        align-items: center;
      }

      .favorites-empty {
        font-size: 0.75rem;
        color: var(--text-muted);
        font-style: italic;
      }

      .favorites-container button {
        padding: 0.4rem 0.8rem;
        font-size: 0.85rem;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 500;
      }

      .favorites-container button:hover {
        background: var(--primary-hover);
        transform: translateY(-2px);
        box-shadow: 0 2px 8px rgba(74, 144, 226, 0.3);
      }

      select {
        width: 100%;
        padding: 0.75rem;
        font-size: 0.95rem;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        background: white;
        color: var(--text-primary);
        cursor: pointer;
        transition: var(--transition);
        margin-bottom: 1rem;
      }

      select:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
      }

      .modes-grid {
        margin: 1rem 0 0 0;
      }

      .mode-category {
        margin-bottom: 1.5rem;
      }

      .category-title {
        font-size: 0.75rem;
        font-weight: 700;
        margin-bottom: 0.6rem;
        opacity: 0.7;
        text-transform: uppercase;
        letter-spacing: 0.6px;
        color: var(--text-secondary);
      }

      .category-modes {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
        justify-content: center;
        text-align: center;
      }

      .mode-item {
        display: flex;
        align-items: center;
        gap: 0.3rem;
        padding: 0.5rem;
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        transition: var(--transition);
        cursor: pointer;
      }

      @media (prefers-color-scheme: dark) {
        .mode-item {
          background: #333;
        }
      }

      .mode-item:hover {
        border-color: var(--primary-color);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        transform: translateY(-1px);
      }

      .mode-item label {
        flex: 1;
        cursor: pointer;
        user-select: none;
        font-size: 0.9rem;
      }

      .mode-item button {
        padding: 0.2rem 0.4rem;
        font-size: 0.8rem;
        background: transparent;
        border: none;
        cursor: pointer;
        transition: var(--transition);
        padding: 2px 6px;
        border-radius: 3px;
      }

      .mode-item button:hover {
        background: rgba(74, 144, 226, 0.1);
        transform: scale(1.15);
      }

      .show-all-toggle {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border-color);
      }

      .show-all-toggle input[type="checkbox"] {
        cursor: pointer;
        width: 18px;
        height: 18px;
      }

      .show-all-toggle label {
        cursor: pointer;
        user-select: none;
        font-size: 0.9rem;
      }

      textarea {
        width: 100%;
        padding: 1rem;
        font-family: inherit;
        font-size: 0.95rem;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        resize: vertical;
        background: white;
        color: var(--text-primary);
        transition: var(--transition);
      }

      @media (prefers-color-scheme: dark) {
        textarea {
          background: #2a2a2a;
        }
      }

      textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
      }

      .textarea-container {
        position: relative;
        margin-bottom: 1rem;
      }

      .delete-btn {
        position: absolute;
        top: -0.75rem;
        right: 0.5rem;
        font-size: 0.75rem;
        padding: 0.3rem 0.6rem;
        background: #e74c3c;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
        transition: var(--transition);
        display: none;
      }

      .delete-btn:hover {
        background: #c0392b;
      }

      button:not(.delete-btn):not(.mode-item button):not(.favorites-container button) {
        padding: 0.7rem 1.5rem;
        font-size: 0.95rem;
        font-weight: 600;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: var(--transition);
        background: var(--primary-color);
        color: white;
      }

      button:not(.delete-btn):not(.mode-item button):not(.favorites-container button):hover {
        background: var(--primary-hover);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      .button-group {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .button-area {
        position: relative;
        display: inline-block;
        margin-bottom: 0.75rem;
      }

      #loaderEl {
        position: absolute;
        right: 0;
        transform: translateX(120%);
        height: 100%;
        display: inline-flex;
        align-items: center;
      }

      .stop-btn-area {
        position: absolute;
        left: 0;
        bottom: 0;
        transform: translateX(-120%);
        height: 100%;
        display: inline-flex;
        align-items: center;
      }

      .controls-top {
        position: absolute;
        top: -2rem;
        left: 0;
        font-size: 0.8rem;
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .controls-bottom {
        position: absolute;
        bottom: -2rem;
        left: 0;
        font-size: 0.8rem;
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .custom-instruction {
        background: var(--bg-secondary);
        padding: 1.5rem;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        margin-bottom: 1rem;
        display: none;
      }

      .custom-instruction.show {
        display: block;
      }

      .info-link {
        text-align: center;
        font-size: 0.85rem;
        color: var(--text-secondary);
        margin-top: 2rem;
      }

      .info-link a {
        color: var(--primary-color);
        text-decoration: none;
        transition: var(--transition);
      }

      .info-link a:hover {
        text-decoration: underline;
      }

      #darkModeBtn {
        position: fixed;
        bottom: 1rem;
        left: 1rem;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: var(--primary-color);
        color: white;
        border: none;
        cursor: pointer;
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: var(--transition);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        z-index: 100;
      }

      #darkModeBtn:hover {
        background: var(--primary-hover);
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <h1>‚ú® AI Text Rewriter Moss NSFW</h1>

    <div class="container">
      <section class="mode-picker">
        <div class="section-title">Choose a Mode</div>
        <div class="favorites-container" id="favoriteModesCtn"></div>

        <select id="modeOptionsTemplate" style="display: none">
          [generateModesHtml()]
        </select>

        <div id="modesGridCtn" class="modes-grid"></div>

        <div class="show-all-toggle">
          <input type="checkbox" id="showGridToggle" onchange="toggleGridView()" />
          <label for="showGridToggle">Browse all modes</label>
        </div>

        <select
          id="currentModeEl"
          onchange="
            localStorage.currentMode = this.value;
            let currentMode = this.value;
            let customCtn = document.getElementById('customModeInstructionCtn');
            customCtn.classList.toggle('show', currentMode === 'custom');
          "
        >
          [generateModesHtml()]
        </select>
      </section>

      <script>
        const modesCategories = {
          Custom: [
            "custom",
            "customMinimal",
            "customLiteral",
            "customCreative",
            "customBulletize",
            "customToneShift"
          ],
          "Tone & Style": [
            "formal",
            "professional",
            "lessSnark",
            "lessPatronizing",
            "lessHostile",
            "humanize",
            "polite",
            "direct",
            "friendly",
            "empathetic",
            "assertive"
          ],
          Academic: [
            "highschoolerCasual",
            "highschoolerEssay",
            "undergradCasual",
            "undergradEssay",
            "gradEssay",
            "researchAbstract",
            "labReport",
            "studyGuide",
            "lectureNotes"
          ],
          Readability: [
            "easierToRead",
            "shorter",
            "longer",
            "wayLonger",
            "smarter",
            "normal",
            "casual",
            "tlDr",
            "bulletPoints",
            "stepByStep",
            "plainLanguage",
            "forKids"
          ],
          "Fun & Personality": [
            "pirate",
            "neko",
            "gigabrain",
            "tipsy",
            "drunk",
            "sarcastic",
            "deadpan",
            "overlyExcited",
            "storybook",
            "noir"
          ],
          "SFW Romance": [
            "flirtyNonExplicit",
            "romantic",
            "dateNightPg13",
            "suggestiveNoSexNoNudity",
            "spicyButSafeFadeToBlack",
            "sweetTalk",
            "heartfelt",
            "poeticRomance",
            "longDistance",
            "slowDance"
          ],
          "Erotic Styles": [
            "erotic",
            "sexual",
            "naughty",
            "horny",
            "romanticErotica",
            "sensual",
            "slowBurn",
            "publicSex",
            "rough",
            "tender",
            "worship",
            "quickie",
            "multipleOrgasms",
            "dirtyTalk",
            "afterglow",
            "teaseAndDeny",
            "heatwave",
            "passionate"
          ],
          "Sexual Acts": [
            "blowjob",
            "cunnilingus",
            "anal",
            "doublePenetration",
            "pegging",
            "squirting",
            "creampie",
            "cumEating",
            "deepthroat",
            "mutualMasturbation",
            "grinding",
            "sixtyNine",
            "outercourse",
            "sensualMassage",
            "showerSex",
            "lapDance",
            "heavyMakeout"
          ],
          "Group Sex": [
            "gangbang",
            "orgy",
            "threesome",
            "hotwife",
            "swinging",
            "cheating",
            "foursome",
            "coupleSwap",
            "partyPlay",
            "openRelationship",
            "groupTease"
          ],
          "Roleplay Scenarios": [
            "schoolgirl",
            "teacher",
            "boss",
            "nurse",
            "maid",
            "stripper",
            "librarian",
            "barista",
            "personalTrainer",
            "roommate",
            "policeOfficer",
            "firefighter",
            "chef",
            "masseuse",
            "photographer"
          ],
          "Physical Features": [
            "bbc",
            "interracial",
            "sizeQueen",
            "milf",
            "dilf",
            "cougar",
            "curvyGirls",
            "bbw",
            "skinny",
            "muscular",
            "tattooed",
            "pierced",
            "petite",
            "thicc",
            "tall",
            "shortGirls",
            "redhead"
          ],
          "Control & Submission": [
            "chastity",
            "denial",
            "begging",
            "permission",
            "obedience",
            "edging",
            "innocent",
            "experienced",
            "powerPlay",
            "bratTamer",
            "softDom",
            "strictDom",
            "subDrop"
          ],
          "Worship & Devotion": [
            "cockWorship",
            "pussyWorship",
            "cumLover",
            "breeding",
            "bodyWorship",
            "assWorship",
            "feetWorship",
            "muscleWorship",
            "adoration"
          ],
          "BDSM & Kink": [
            "bdsm",
            "femboy",
            "sissy",
            "crossDress",
            "submissive",
            "dominant",
            "primal",
            "ropeBunny",
            "leatherDaddy",
            "petPlay",
            "agePlay",
            "voyeur",
            "exhibitionist",
            "orgasmControl",
            "impactPlay",
            "humiliation",
            "degradation",
            "praiseKink",
            "spanking",
            "choking",
            "edgeplay",
            "waxPlay",
            "knifePlay",
            "footFetish",
            "gloryhole",
            "shibari",
            "suspension",
            "caging",
            "collaring",
            "leashing"
          ],
          "Body Dynamics": [
            "genderBend",
            "futanari",
            "sizeDifference",
            "monsterFuck",
            "tentacle",
            "transformation",
            "lactation",
            "pregnancy",
            "inflation",
            "omorashi",
            "waterSports",
            "scat",
            "vore",
            "musk",
            "expansion",
            "shrinking",
            "giantess",
            "macro",
            "belly"
          ],
          "Mind & Body": [
            "incubus",
            "succubus",
            "dollification",
            "mindControl",
            "hypnosis",
            "corruption",
            "masochist",
            "sadist",
            "sensoryDeprivation",
            "overstimulation",
            "dollPlay",
            "aphrodisiac",
            "drugged",
            "intoxication",
            "possesion",
            "ecstasy"
          ],
          "Fantasy & Supernatural": [
            "furry",
            "ponyPlay",
            "petrification",
            "ghost",
            "vampire",
            "werewolf",
            "alien",
            "robot",
            "slime",
            "parasite",
            "demon",
            "angel",
            "mermaid",
            "centaur",
            "dragonRider"
          ],
          "Sexuality & Gender": [
            "gay",
            "lesbian",
            "bisexual",
            "pansexual",
            "nonBinary",
            "genderFluid",
            "transmasc",
            "transFemme",
            "drag",
            "androgynous",
            "queer",
            "demisexual",
            "asexual",
            "sapiosexual",
            "graysexual",
            "agender",
            "demiboy",
            "demigirl",
            "genderqueer",
            "twoSpirit",
            "polyamorous",
            "kinksterIdentity",
            "aceSpectrum",
            "aroSpectrum",
            "questioning"
          ],
          "Trans & Gender": [
            "transgender",
            "feminization",
            "preOp",
            "postOp",
            "nonOp",
            "genderAffirming",
            "transJoy",
            "binders",
            "packers",
            "tucking"
          ],
          "Advanced BDSM": [
            "cuckold",
            "leather",
            "latex",
            "bondage",
            "freeUse",
            "omegaverse",
            "switch",
            "bratty",
            "rigger",
            "service",
            "24seven"
          ],
          "Specific Acts & Sensations": [
            "faceSitting",
            "rimjob",
            "asslicking",
            "fingeringFemale",
            "handjob",
            "titfuck",
            "dildoRiding",
            "humping",
            "clothedSex",
            "quickDispose",
            "thighing",
            "pussySlap",
            "cockSlap",
            "teasingTouch",
            "dryHumping"
          ],
          "Cum & Fluids": [
            "cumshot",
            "facial",
            "mouthful",
            "bukkake",
            "swallow",
            "semen",
            "cumSwap",
            "squirtGush",
            "girlcum",
            "messy",
            "cumInside",
            "creampie",
            "cumOnBody",
            "cumPlay",
            "overflowing"
          ],
          "Sex Toys & Devices": [
            "vibrator",
            "dildo",
            "strapon",
            "prostate",
            "enema",
            "buttplug",
            "cockring",
            "lovense",
            "fuckMachine",
            "pocketPussy"
          ],
          "Public & Voyeur": [
            "dogging",
            "public",
            "semipublic",
            "hidden",
            "liveAudience",
            "beingWatched",
            "carSex",
            "officeQuickie",
            "changingRoom",
            "outdoorSex"
          ],
          "Degradation & Humiliation": [
            "slut",
            "whore",
            "dacryphilia",
            "dominantWoman",
            "nameCalling",
            "verbal",
            "objectification",
            "dumbification",
            "petNames"
          ],
          "Fantasy & Roleplay": [
            "roleplay",
            "cnc",
            "ageGap",
            "beastilityFantasy",
            "kidnapping",
            "captive",
            "rescue",
            "medieval",
            "sciFi"
          ],
          "Breeding & Fertility": [
            "breedingKink",
            "breeding",
            "impregnation",
            "broodmare",
            "seedingKnot",
            "fertilization",
            "ovulation"
          ],
          "Extreme Kink": [
            "cbt",
            "ballbusting",
            "castration",
            "needlePlay",
            "bloodPlay",
            "branding",
            "cutting",
            "extremePain"
          ],
          "Clothing & Fetish Materials": [
            "fetishBoots",
            "heels",
            "panties",
            "lingerie",
            "stockings",
            "nylons",
            "spandex",
            "pvc",
            "vinyl",
            "rubber",
            "corset",
            "gloves",
            "fishnets",
            "satin",
            "lace",
            "garter",
            "thong"
          ],
          "Restraint & Bondage Play": [
            "blindfold",
            "gagged",
            "restrained",
            "cuffed",
            "spreaderBar",
            "hogtied",
            "mummification",
            "stocks",
            "strap"
          ],
          "Mind Control": [
            "hypnosis",
            "brainwashing",
            "mindBreak",
            "triggerWords",
            "submission",
            "conditioning"
          ]
        };

        let modesData = [];

        function getFavoriteModes() {
          try {
            return JSON.parse(localStorage.favoriteModes || "[]");
          } catch {
            return [];
          }
        }

        function setFavoriteModes(list) {
          localStorage.favoriteModes = JSON.stringify(list);
          renderFavorites();
          renderGrid();
        }

        function toggleFavorite(modeName) {
          let favorites = getFavoriteModes();
          let idx = favorites.indexOf(modeName);
          if (idx >= 0) {
            favorites.splice(idx, 1);
          } else {
            favorites.push(modeName);
          }
          setFavoriteModes(favorites);
        }

        function selectMode(modeName) {
          localStorage.currentMode = modeName;
          currentModeEl.value = modeName;
          let customCtn = document.getElementById("customModeInstructionCtn");
          customCtn.classList.toggle("show", modeName === "custom");
        }

        function renderFavorites() {
          let favorites = getFavoriteModes();
          let favCtn = document.getElementById("favoriteModesCtn");
          favCtn.innerHTML = "";

          if (favorites.length === 0) {
            favCtn.innerHTML = "<span class='favorites-empty'>Click ‚òÖ to add favorites</span>";
            return;
          }

          favorites.forEach((modeName) => {
            let mode = modesData.find((m) => m.name === modeName);
            if (!mode) return;
            let btn = document.createElement("button");
            btn.type = "button";
            btn.textContent = mode.label;
            btn.onclick = () => selectMode(modeName);
            favCtn.appendChild(btn);
          });
        }

        function renderGrid() {
          let gridCtn = document.getElementById("modesGridCtn");
          gridCtn.innerHTML = "";
          let favorites = new Set(getFavoriteModes());

          Object.entries(modesCategories).forEach(([category, modeNames]) => {
            let catDiv = document.createElement("div");
            catDiv.className = "mode-category";

            let catTitle = document.createElement("div");
            catTitle.className = "category-title";
            catTitle.textContent = category;
            catDiv.appendChild(catTitle);

            let row = document.createElement("div");
            row.className = "category-modes";

            modeNames.forEach((modeName) => {
              let mode = modesData.find((m) => m.name === modeName);
              if (!mode) return;

              let itemDiv = document.createElement("div");
              itemDiv.className = "mode-item";

              let label = document.createElement("label");
              label.textContent = mode.label;

              let favBtn = document.createElement("button");
              favBtn.type = "button";
              favBtn.textContent = favorites.has(modeName) ? "‚òÖ" : "‚òÜ";
              favBtn.onclick = (e) => {
                e.stopPropagation();
                toggleFavorite(modeName);
              };

              label.onclick = () => selectMode(modeName);
              itemDiv.appendChild(label);
              itemDiv.appendChild(favBtn);
              row.appendChild(itemDiv);
            });

            catDiv.appendChild(row);
            gridCtn.appendChild(catDiv);
          });
        }

        function toggleGridView() {
          let toggle = document.getElementById("showGridToggle");
          let gridCtn = document.getElementById("modesGridCtn");
          gridCtn.style.display = toggle.checked ? "block" : "none";
        }

        function initModePicker() {
          modesData = Array.from(modeOptionsTemplate.options).map((option) => {
            return { name: option.value, label: option.textContent };
          });
          renderFavorites();
          renderGrid();

          let currentMode =
            localStorage.currentMode || (modesData[0] ? modesData[0].name : "custom");
          currentModeEl.value = currentMode;
          let showCustom = currentMode === "custom";
          document.getElementById("customModeInstructionCtn").style.display = showCustom
            ? ""
            : "none";
        }

        setTimeout(() => {
          initModePicker();
        }, 100);
      </script>

      <section class="custom-instruction" id="customModeInstructionCtn">
        <div class="section-title">Custom Instruction</div>
        <textarea
          id="customModeInstructionEl"
          placeholder="Type your custom rewriting instruction here, like: 'make it sound smarter' or 'make it sound like it was written by a 4th grade student'"
          style="height: 80px; margin-bottom: 0"
          oninput="localStorage.customModeInstruction = this.value"
        ></textarea>
        <script>
          if (localStorage.customModeInstruction) {
            customModeInstructionEl.value = localStorage.customModeInstruction;
          }
          setTimeout(() => {
            let currentMode = localStorage.currentMode || "custom";
            if (currentMode === "custom") {
              document.getElementById("customModeInstructionCtn").classList.add("show");
            }
          }, 100);
        </script>
      </section>

      <section>
        <div class="section-title">Input Text</div>
        <div class="textarea-container">
          <textarea
            id="inputTextEl"
            placeholder="Paste the text that you wish to convert."
            style="height: 120px"
            oninput="
              if (this.value.trim() == '') {
                inputTextDeleteBtn.style.display = 'none';
              } else {
                inputTextDeleteBtn.style.display = '';
              }
              localStorage.instruction = this.value;
            "
          ></textarea>
          <button
            id="inputTextDeleteBtn"
            class="delete-btn"
            data-mode="delete"
            onclick="
              if (this.dataset.mode === 'delete') {
                window.deletedInputText = inputTextEl.value;
                inputTextEl.value = '';
                this.dataset.mode = 'undo';
                this.textContent = '‚Ü©Ô∏è undo';
              } else {
                inputTextEl.value = window.deletedInputText;
                this.dataset.mode = 'delete';
                this.textContent = 'üóëÔ∏è delete';
              }
              localStorage.instruction = inputTextEl.value;
            "
            style="display: none"
          >
            üóëÔ∏è delete
          </button>
          <script>
            if (localStorage.instruction) {
              inputTextEl.value = localStorage.instruction;
              inputTextDeleteBtn.style.display = "";
            }
          </script>
        </div>
      </section>

      <div style="text-align: center">
        <div class="button-area">
          <button
            id="generateBtn"
            onclick="
              responseEl.value = '';
              generate();
            "
            style="font-size: 1.1rem; padding: 0.8rem 2rem"
          >
            ‚ú® Convert Text
          </button>
          <div id="loaderEl"></div>
          <div class="stop-btn-area">
            <button id="stopBtn" style="display: none">üõë Stop</button>
          </div>
        </div>
      </div>

      <section>
        <div class="section-title">Output Text</div>
        <div class="textarea-container">
          <textarea
            id="responseEl"
            placeholder="The converted text will appear here. You can edit it and click 'Continue' to refine it further."
            style="height: 300px"
            oninput="
              if (this.value.trim() == '') {
                continueBtn.disabled = true;
                bottomContinueBtn.disabled = true;
                generateBtn.textContent = '‚ú® Convert Text';
                responseDeleteBtn.style.display = 'none';
              } else {
                continueBtn.disabled = false;
                bottomContinueBtn.disabled = false;
                generateBtn.textContent = 'üîÑ Regenerate';
                responseDeleteBtn.style.display = '';
              }
              localStorage.response = this.value;
              retryBtn.disabled = true;
            "
          ></textarea>
          <button
            id="responseDeleteBtn"
            class="delete-btn"
            data-mode="delete"
            onclick="
              if (this.dataset.mode === 'delete') {
                if (stopBtn.offsetParent) stopBtn.click();
                window.deletedResponse = responseEl.value;
                responseEl.value = '';
                this.dataset.mode = 'undo';
                this.textContent = '‚Ü©Ô∏è undo';
              } else {
                responseEl.value = window.deletedResponse;
                this.dataset.mode = 'delete';
                this.textContent = 'üóëÔ∏è delete';
              }
              localStorage.response = responseEl.value;
            "
            style="display: none"
          >
            üóëÔ∏è delete
          </button>
          <script>
            if (localStorage.response) {
              responseEl.value = localStorage.response;
              responseDeleteBtn.style.display = "";
              continueBtn.disabled = false;
              bottomContinueBtn.disabled = false;
            }
          </script>
          <div class="controls-top">
            <button disabled id="continueBtn" onclick="generate()">‚ñ∂Ô∏è Continue</button>
            <button
              disabled
              id="retryBtn"
              onclick="
                responseEl.value = window.responseContentBeforeLastGenerate || responseEl.value;
                generate();
              "
            >
              üîÅ Retry
            </button>
          </div>
          <div class="controls-bottom">
            <button disabled id="bottomContinueBtn" onclick="generate()">‚ñ∂Ô∏è Continue</button>
            <button id="bottomStopBtn" style="display: none">üõë Stop</button>
          </div>
        </div>
      </section>

      <p class="info-link">
        Also check out the
        <a href="https://perchance.org/ai-text-rewriter-moss" target="_blank">
          AI Text Rewriter Moss
        </a>
        version.
      </p>
    </div>

    <!-- DARK MODE TOGGLE -->
    <button id="darkModeBtn" title="Toggle dark mode">üåÉ</button>

    <script>
      function toggleManualDarkMode() {
        let newColorScheme = getCurrentColorScheme() === "dark" ? "light" : "dark";
        localStorage.forceColorScheme = newColorScheme;
        setColorScheme(newColorScheme);
        let systemColorScheme =
          window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
            ? "dark"
            : "light";
        if (systemColorScheme === newColorScheme) {
          localStorage.removeItem("forceColorScheme");
        }
      }

      function getCurrentColorScheme() {
        if (localStorage.forceColorScheme !== undefined) {
          return localStorage.forceColorScheme;
        }
        return window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
          ? "dark"
          : "light";
      }

      function setColorScheme(scheme) {
        if (scheme !== "dark" && scheme !== "light")
          throw new Error("scheme should be 'light' or 'dark'");
        document.querySelector("#darkModeBtn").textContent = scheme === "dark" ? "üåÑ" : "üåÉ";
        if (scheme === "dark") {
          document.documentElement.style.colorScheme = "dark";
        } else {
          document.documentElement.style.colorScheme = "light";
        }
      }

      if (localStorage.forceColorScheme !== undefined) {
        setColorScheme(localStorage.forceColorScheme);
      } else {
        let systemIsInDarkMode = !!(
          window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
        );
        setColorScheme(systemIsInDarkMode ? "dark" : "light");
      }

      document.getElementById("darkModeBtn").addEventListener("click", toggleManualDarkMode);
    </script>
  </body>
</html>
